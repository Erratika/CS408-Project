{% load static from staticfiles %}
<!DOCTYPE html>
<meta charset="utf-8">
<style>
    svg {
        border: 1px solid black;
    }

    .region {
        fill: cornflowerblue;
    }

    .region:hover {
        fill: red;
    }

    .boundary {
        fill: none;
        stroke: #777;
    }
</style>
<svg></svg>
<script src="https://d3js.org/d3.v5.min.js"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>

<script>
    //Define SVG width and height
    var width = 600,
        height = 600;
    //Create SVG
    var zoom = d3.zoom().scaleExtent([1, 10])
        .on("zoom", function () {
            svg.selectAll('path') // To prevent stroke width from scaling
                .attr('transform', d3.event.transform)
            svg.selectAll('.boundary').style('stroke-width',1/d3.event.transform.k+'px')


        });

    //Create SVG
    var svg = d3.select("svg")
        .attr("width", width)
        .attr("height", height).call(zoom);
    d3.json("{% static 'hostels/maps/topo_lad.json' %}").then(function (topology) {
        //Get Json object data
        var json = topojson.feature(topology, topology.objects.lad);

        //Define Projection model
        var center = d3.geoCentroid(json);
        var scale = 200;
        var offset = [width / 2, height / 2];
        var projection = d3.geoMercator().scale(scale).center(center)
            .translate(offset);

        // create the path
        var path = d3.geoPath().projection(projection);

        // using the path determine the bounds of the current map and use
        // these to determine better values for the translation
        var bounds = path.bounds(json);
        var offset = [width - (bounds[0][0] + bounds[1][0]) / 2,
            height - (bounds[0][1] + bounds[1][1]) / 2];

        // new projection
        projection = d3.geoMercator().center(center)
            .scale(4000).translate(offset);
        path = path.projection(projection);

        svg.selectAll("path")
            .data(json.features)
            .enter().append("path")
            .attr("d", path).attr("class", "region");

        svg.append("path")
            .datum(topojson.mesh(topology, topology.objects.lad))
            .attr("d", path)
            .attr("class", "boundary");


    });

</script>